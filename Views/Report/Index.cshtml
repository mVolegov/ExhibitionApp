@{
    ViewData["Title"] = "Отчеты и импорт";
    var ImportTables = (SelectList)ViewData["ImportTables"]!;
    var ExportTables = (SelectList)ViewData["ExportTables"]!;
    var ErrorMessage = (string)(ViewData["ErrorMessage"] ?? "");
}

<h1 class="mt-4 text-center">Отчеты и импорт</h1>
<div>
    @ErrorMessage
</div>

<div class="row g-2 mt-3">
    <div class="col-sm-12">
        <h3>
            Отчеты
        </h3>

        <ul class="list-group">
            <li class="list-group-item">
                <form asp-action="ExhibitsReport" class="text-center">
                    <h4 class="mt-2">Об экспонатах (учитывая даты поступления). Пустые даты для отчета за сегодня.</h4>
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="dateStartArrivedId" class="form-label"></label>
                            <input id="dateStartArrivedId" name="dateStartArrived" type="date" class="form-control" />
                        </div>
                        <div class="col-sm-6">
                            <label for="dateEndArrivedId" class="form-label"></label>
                            <input id="dateEndArrivedId" name="dateEndArrived" type="date" class="form-control" />
                        </div>
                    </div>
                    <input class="btn btn-outline-primary mt-3" type="submit" value="Получить отчет" />
                </form>
            </li>
            <li class="list-group-item">
                <form asp-action="ExcelReport" class="text-center">
                    <h4 class="mt-2">Сводный отчет по экспонатам (Excel)</h4>
                    <input class="btn btn-outline-primary mt-2" type="submit" value="Получить отчет" />
                </form>
            </li>
        </ul>
    </div>

    <div class="col-sm-6 mt-5 pe-2">
        <h4>Импорт</h4>
        <form asp-action="Import" enctype="multipart/form-data" class="card p-4">
            <div class="from-group">
                <label for="importTableId" class="control-label">Таблица</label>
                <select id="importTableId" name="importTable" asp-items="ImportTables" class="form-control"></select>
            </div>
            <div class="from-group mt-2">
                <label for="importFileId" class="control-label">Файл .csv</label>
                <input id="importFileId" name="importFile" type="file" class="form-control" />
            </div>
            <div class="from-group mt-3">
                <input class="btn btn-success" type="submit" value="Импортировать" />
            </div>
        </form>
    </div>

    <div class="col-sm-6 mt-5 ps-2">
        <h4>Экспорт</h4>
        <form asp-action="Export" class="card p-4">
            <div class="form-group">
                <label for="exportTableId" class="control-label">Таблица</label>
                <select id="exportTableId" name="exportTable" asp-items="ExportTables" class="form-control"></select>
            </div>
            <div class="form-group mt-3">
                <input class="btn btn-success" type="submit" value="Экспортировать" />
            </div>
        </form>
    </div>
</div>